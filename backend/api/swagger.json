{
    "openapi": "3.0.0",
    "info": {
        "title": "Datahub REST API",
        "version": "2.0"
    },
    "paths": {
        "/datasets/{name}/tokens": {
            "get": {
                "summary": "List all dataset tokens",
                "responses": {
                    "200": {
                        "description": "OK"
                    }
                }
            },
            "post": {
                "summary": "Create new dataset token",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "enabled": {
                                        "type": "boolean"
                                    },
                                    "read": {
                                        "type": "boolean"
                                    },
                                    "write": {
                                        "type": "boolean"
                                    },
                                    "desc": {
                                        "type": "string"
                                    }
                                },
                                "type": "object",
                                "example": {
                                    "enabled": true,
                                    "read": false,
                                    "write": true,
                                    "desc": "Temperature sensors input"
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Dataset not found"
                    }
                }
            }
        },
        "/datasets/{name}/token/{id}": {
            "put": {
                "summary": "Update dataset token",
                "parameters": [
                    {
                        "name": "name",
                        "in": "path",
                        "description": "Name of dataset.",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Id of token.",
                        "required": true,
                        "schema": {
                            "type": "number"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "email": {
                                        "type": "string"
                                    }
                                },
                                "type": "object",
                                "example": {
                                    "enabled": false,
                                    "read": true,
                                    "write": false,
                                    "desc": "Data extraction"
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Dataset not found"
                    }
                }
            }
        },
        "/datasets/{name}/tokens/{id}": {
            "delete": {
                "summary": "Delete dataset token",
                "parameters": [
                    {
                        "name": "name",
                        "in": "path",
                        "description": "Name of dataset.",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Dataset not found"
                    }
                }
            }
        },
        "/datasets": {
            "get": {
                "summary": "List all datasets",
                "responses": {
                    "200": {
                        "description": "OK"
                    }
                }
            },
            "post": {
                "summary": "Create new dataset",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "desc": {
                                        "type": "string"
                                    }
                                },
                                "type": "object",
                                "example": {
                                    "name": "my-dataset",
                                    "desc": "Aparament temperature and humidity"
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "400": {
                        "description": "Invalid name"
                    }
                }
            }
        },
        "/datasets/{name}": {
            "get": {
                "summary": "Retrieve dataset information",
                "parameters": [
                    {
                        "name": "name",
                        "in": "path",
                        "description": "Name of dataset.",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Dataset not found"
                    }
                }
            },
            "put": {
                "summary": "Update dataset",
                "parameters": [
                    {
                        "name": "name",
                        "in": "path",
                        "description": "Name of dataset.",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "email": {
                                        "type": "string"
                                    }
                                },
                                "type": "object",
                                "example": {
                                    "name": "dataset2",
                                    "desc": "My second dataset"
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Dataset not found"
                    }
                }
            },
            "delete": {
                "summary": "Delete dataset",
                "parameters": [
                    {
                        "name": "name",
                        "in": "path",
                        "description": "Name of dataset.",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Dataset not found"
                    }
                }
            }
        },
        "/nodes": {
            "get": {
                "summary": "List all nodes",
                "responses": {
                    "200": {
                        "description": "OK"
                    }
                }
            },
            "post": {
                "summary": "Create new node",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "desc": {
                                        "type": "string"
                                    }
                                },
                                "type": "object",
                                "example": {
                                    "name": "garage",
                                    "desc": "Located in the ceiling"
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "400": {
                        "description": "Invalid name"
                    },
                    "403": {
                        "description": "Not authorized"
                    }
                }
            }
        },
        "/nodes/{name}": {
            "get": {
                "summary": "Retrieve node information",
                "parameters": [
                    {
                        "name": "name",
                        "in": "path",
                        "description": "Name of node.",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Node not found"
                    }
                }
            },
            "put": {
                "summary": "Update node",
                "parameters": [
                    {
                        "name": "name",
                        "in": "path",
                        "description": "Name of node.",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "email": {
                                        "type": "string"
                                    }
                                },
                                "type": "object",
                                "example": {
                                    "name": "node2",
                                    "desc": "My second node"
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Node not found"
                    }
                }
            },
            "delete": {
                "summary": "Delete node",
                "parameters": [
                    {
                        "name": "name",
                        "in": "path",
                        "description": "Name of node.",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Node not found"
                    }
                }
            }
        },
        "/users": {
            "get": {
                "summary": "List all users. Requires admin privileges.",
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "403": {
                        "description": "Not authorized"
                    }
                }
            },
            "post": {
                "summary": "Create new user",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "username": {
                                        "type": "string"
                                    },
                                    "password": {
                                        "type": "string"
                                    }
                                },
                                "type": "object",
                                "example": {
                                    "username": "foo",
                                    "password": "bar"
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "400": {
                        "description": "Invalid username"
                    }
                }
            }
        },
        "/users/{username}": {
            "get": {
                "summary": "Retrieve user information",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "description": "Username of user. Requires admin privileges for other users than your own.",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "403": {
                        "description": "Not authorized"
                    },
                    "404": {
                        "description": "User not found"
                    }
                }
            },
            "put": {
                "summary": "Update user",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "description": "Username of user. Requires admin privileges for other users than your own.",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "email": {
                                        "type": "string"
                                    }
                                },
                                "type": "object",
                                "example": {
                                    "email": "foo@bar.com",
                                    "admin": true
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "403": {
                        "description": "Not authorized"
                    },
                    "404": {
                        "description": "User not found"
                    }
                }
            }
        },
        "/users/{username}/login": {
            "post": {
                "summary": "Login",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "description": "Username of user",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "password": {
                                        "type": "string"
                                    }
                                },
                                "type": "object",
                                "example": {
                                    "password": "bar"
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "403": {
                        "description": "Invalid credentials"
                    }
                }
            }
        },
        "/users/{username}/impersonate": {
            "get": {
                "summary": "Impersonate a user",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "description": "Username of user",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "403": {
                        "description": "Not authorized"
                    },
                    "404": {
                        "description": "User not found"
                    }
                }
            }
        }
    }
}